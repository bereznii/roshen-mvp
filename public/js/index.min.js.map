{"version":3,"sources":["node_modules/browser-pack/_prelude.js","resources/js/index.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","loading","currLocation","formElements","productId","hideSection","sectionId","section","document","getElementById","style","display","setAttribute","showSection","removeAttribute","showError","error","sectionError","items","_typeof","Object","prototype","toString","innerHTML","concat","map","desc","join","window","scrollTo","showProduct","product","properties","image","description","name","productElement","property","labels","val","input","id","list","form","reduce","dict","key","selector","hasOwnProperty","elements","querySelectorAll","addEventListener","onInput","onChange","submitBtn","querySelector","validateForm","event","preventDefault","data","product_id","vote","element","type","checked","push","property_id","value","token","getAttribute","xhr","XMLHttpRequest","responseType","onreadystatechange","this","readyState","response","status","votes","localStorage","getItem","arr","JSON","parse","setItem","stringify","err","addProductVoted","sectionForm","sectionSuccess","sectionContact","showFormResult","console","log","open","setRequestHeader","send","submitForm","_submitBtn","blur","initForm","validateFormElement","validity","test","valid","classList","remove","closest","add","target","setRadioRating","navigate","pathname","arguments","undefined","location","history","pushState","path","split","indexOf","checkIsProductVoted","url","params","getProduct","handleLink","nodeName","linkTarget","href","defaultPrevented","button","metaKey","altKey","ctrlKey","shiftKey","isModifiedEvent","handlePopstate","init","Element","matches","msMatchesSelector","webkitMatchesSelector","s","el","parentElement","parentNode","nodeType"],"mappings":"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","file":"index.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","let loading = true;\nlet currLocation = null;\nlet formElements = {};\nlet productId = null;\n\nfunction hideSection(sectionId) {\n    const section = document.getElementById(sectionId);\n    if (section) {\n        section.style.display = 'none';\n        section.setAttribute('hidden', 'hidden');\n    }\n};\n\nfunction showSection(sectionId) {\n    const section = document.getElementById(sectionId);\n    if (section) {\n        section.style.display = 'block';\n        section.removeAttribute('hidden');\n    }\n};\n\nfunction showError(error) {\n    hideSection('index');\n    hideSection('estimate');\n    hideSection('success');\n    const sectionError = document.getElementById('error');\n    if (sectionError) {\n        let items = [];\n        if (typeof error === 'string') {\n            items = [error];\n        } else if (typeof error === 'object' && Object.prototype.toString.call( error ) === '[object Array]' && error.length) {\n            items = error;\n        } else {\n            items = ['Дякуємо, але...', 'Ви вже голосували'];\n        }\n        sectionError.innerHTML = `\n            <div class=\"info__content\">\n                <img class=\"info__image\" src=\"/img/warning.png\" srcset=\"/img/warning@2x.png 2x, /img/warning.png 1x\" alt=\"\">\n                ${ items.map(desc => `<p class=\"info__description\">${desc}</p>`).join('\\n') }\n            </div>\n        `;\n        showSection('error');\n    }\n    showSection('contact');\n    window.scrollTo(0, 0);\n}\n\nfunction showProduct(product, properties) {\n    if (!product || !properties || !properties.length) return showError('Продукт не знайдено');\n    const section = document.getElementById('estimate');\n    if (!section) return;\n\n    const heart = `\n        <svg width=\"22\" height=\"21\" viewBox=\"0 0 22 21\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M15.553 0c-1.447 0-2.38.172-3.45.696a6.166 6.166 0 00-1.113.7A6.3 6.3 0 009.922.728C8.832.188 7.85 0 6.455 0 2.716 0 0 3.097 0 7.12c0 3.038 1.694 5.972 4.849 8.81 1.656 1.49 3.77 2.963 5.285 3.747l.866.45.866-.45c1.515-.784 3.63-2.258 5.285-3.747C20.306 13.092 22 10.158 22 7.12 22 3.14 19.258.015 15.553 0zM20 7.12c0 2.38-1.414 4.83-4.186 7.323-1.512 1.36-3.455 2.718-4.814 3.43-1.359-.712-3.302-2.07-4.814-3.43C3.414 11.949 2 9.5 2 7.12 2 4.148 3.884 2 6.455 2c1.11 0 1.793.132 2.58.52.465.23.876.534 1.232.914l.735.785.73-.791a4.18 4.18 0 011.25-.936C13.746 2.118 14.387 2 15.549 2 18.09 2.01 20 4.189 20 7.12z\"/>\n            <path d=\"M15.553 0c-1.447 0-2.381.172-3.45.696a6.146 6.146 0 00-1.113.7A6.316 6.316 0 009.922.728C8.831.189 7.85 0 6.455 0 2.716 0 0 3.097 0 7.12c0 3.038 1.694 5.972 4.849 8.81 1.656 1.489 3.77 2.963 5.285 3.747l.866.449.866-.449c1.515-.784 3.629-2.258 5.285-3.747C20.306 13.092 22 10.158 22 7.12 22 3.14 19.258.015 15.553 0z\" fill-rule=\"evenodd\"/>\n        </svg>\n    `;\n    const title = `<h1 class=\"estimate__title\">Запрошуємо прийняти участь в оцінці нашого виробу</h1>`;\n    const subtitle = `<p class=\"estimate__subtitle\">Ваша оцінка можлива тільки ОДИН раз</p>`;\n    const image = `<img class=\"estimate__image\" src=\"${product.image || '/img/products/candy-nut.png'}\" alt=\"\">`;\n    const description = `<p class=\"estimate__description\">${product.name || ''}</p>`;\n    const productElement = `<div class=\"estimate__product\">${image}${description}</div>`;\n    const items = properties.map(property => {\n        const name = `<span class=\"estimate__name\">${ property.name || ''}</span>`;\n        const labels = [1, 2, 3, 4, 5].map(val => {\n            const input = `<input class=\"rating__radio\" type=\"radio\" name=\"property-${ property.id }\" value=\"${ val }\" required>`;\n            return `<label class=\"rating__item\">${ val } ${input} ${heart}</label>`;\n        });\n        return `<li class=\"estimate__item\">${name} <div class=\"rating\"> ${labels.join('\\n')} </div> </li>`\n    });\n    const list = `<ul class=\"estimate__list\">${items.join('\\n')}</ul>`;\n    const submitBtn = `<button class=\"button\" type=\"submit\" disabled>Готово</button>`;\n    const form = `<form class=\"estimate__rating\" id=\"rating-form\" action=\"\">${list}${submitBtn}</form>`;\n\n    section.innerHTML = `${title} ${subtitle} ${productElement} ${form}`;\n    section.style.display = 'block';\n    section.removeAttribute('hidden');\n\n    productId = product.id;\n    formElements = properties.reduce((dict, property) => {\n        const key = 'property-' + property.id;\n        dict[key] = {\n            id: property.id,\n            name: key,\n            selector: `input[name=\"${key}\"]`\n        };\n        return dict;\n    }, formElements || {});\n    initForm();\n}\n\nfunction checkIsProductVoted(productId) {\n    const votes = window.localStorage.getItem('votes');\n    if (!votes) return false;\n    try {\n        const arr = JSON.parse(votes);\n        return arr.indexOf('' + productId) >= 0 || arr.indexOf(+productId) >= 0;\n    } catch(err) {\n        return false;\n    }\n}\n\nfunction addProductVoted(productId) {\n    const votes = window.localStorage.getItem('votes') || '[]';\n    try {\n        const arr = JSON.parse(votes);\n        arr.push(productId);\n        window.localStorage.setItem('votes', JSON.stringify(arr));\n    } catch(err) {\n        return false;\n    }\n}\n\nfunction getProduct(product) {\n    if (!product) return;\n\n    const url = '/api/product/' + product;\n    const method = 'GET';\n    const token = document.querySelector('meta[name=\"csrf-token\"]').getAttribute('content');\n\n    const params = {\n        id: product\n    };\n\n    const arr = [];\n    for (let key in params) {\n        if (params.hasOwnProperty(key)) {\n            arr.push(`${key}=${params[key]}`);\n        }\n    }\n    const data = arr.join('&');\n\n    const xhr = new XMLHttpRequest();\n    if ( ( xhr.responseType = 'json') === xhr.responseType ) {\n        xhr.onreadystatechange = function() {\n            if (this.readyState === 4) {\n                const response = this.response;\n                if (this.status === 200) {\n                    if (response && response.status && response.status === 'success' && response.product && response.properties) {\n                        showProduct(response.product, response.properties)\n                    } else {\n                        console.log('getProduct error, no success', response);\n                        showError('Продукт не знайдено');\n                    }\n                } else {\n                    console.log('getProduct failed', response);\n                    showError('Сталася помилка');\n                }\n            }\n        }\n        xhr.open(method, `${url}?${data}`, true);\n        xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');\n        xhr.setRequestHeader('X-CSRF-TOKEN', token);\n        xhr.send();\n    } else {\n        console.log('not supported responseType')\n    }\n}\n\nfunction setRadioRating(element) {\n    if (element && element.type === 'radio') {\n        const name = element.getAttribute('name');\n        const value = element.getAttribute('value');\n        const form = element.form;\n        const elements = form.querySelectorAll(`input[name=\"${name}\"]`);\n        for (let i = 0; i < elements.length; i++) {\n            if (elements[i] && elements[i].type === 'radio') {\n                if (elements[i].value <= value) {\n                    elements[i].closest('label').classList.add('active');\n                } else {\n                    elements[i].closest('label').classList.remove('active');\n                }\n            }\n        }\n    }\n}\n\nfunction validateFormElement(element) {\n    if (!element || !element.validity) {\n        return false;\n    }\n    const patternEmpty = /[^\\s]+/;  // string full of spaces\n    if (element.value === '' || !patternEmpty.test(element.value)) {\n        return false;\n    }\n    if (!element.validity.valid) {\n        return false;\n    }\n    return true;\n}\n\nfunction validateForm(formElements) {\n    let valid = true;\n    for (let key in formElements) {\n        if (formElements.hasOwnProperty(key) && formElements[key] && formElements[key].elements) {\n            let elements = formElements[key].elements;\n            if (!elements || !elements.length) {\n                console.log('no elements');\n                return true;\n            }\n            let element = null;\n            let checked = false;\n            for (let i = 0; i < elements.length; i++) {\n                element = elements[i];\n                if (!element || !element.validity) {\n                    console.log('no validation');\n                    return true;\n                }\n                if (element.type === 'radio') {\n                    checked = checked || element.checked;\n                } else {\n                   if (validateFormElement(element)) {\n                        element.classList.remove('invalid');\n                        element.closest('label').classList.remove('invalid');\n                    } else {\n                        element.classList.add('invalid');\n                        element.closest('label').classList.add('invalid');\n                        valid = false;\n                    } \n                }\n            }\n            if (element.type === 'radio') {\n                valid = checked;\n            }\n        }\n    }\n    return valid;\n}\n\nfunction onInput(event) {\n    let element = event.target;\n    if (!element || !element.validity) {\n        return;\n    }\n    let valid = validateFormElement(element);\n    const form = element.form;\n    const submitBtn = form.querySelector('button[type=\"submit\"]');\n    if (valid) {\n        element.classList.remove('invalid');\n        element.closest('label').classList.remove('invalid');\n        submitBtn.removeAttribute('disabled');\n        if (validateForm(formElements)) {\n            submitBtn.removeAttribute('disabled');\n        } else {\n            submitBtn.setAttribute('disabled', 'disabled');\n        }\n    }\n}\n\nfunction onChange(event) {\n    let element = event.target;\n    if (!element || !element.validity) {\n        return;\n    }\n    let valid = validateFormElement(element);\n    const form = element.form;\n    const submitBtn = form.querySelector('button[type=\"submit\"]');\n    if (valid) {\n        element.classList.remove('invalid');\n        element.closest('label').classList.remove('invalid');\n    } else {\n        element.classList.add('invalid');\n        element.closest('label').classList.add('invalid');\n    }\n    if (element.type === 'radio') {\n        setRadioRating(element);\n    }\n    if (validateForm(formElements)) {\n        submitBtn.removeAttribute('disabled');\n    } else {\n        submitBtn.setAttribute('disabled', 'disabled');\n    }\n}\n\nfunction showFormResult() {\n    const sectionForm = document.getElementById('estimate');\n    if (sectionForm) {\n        sectionForm.style.display = 'none';\n        sectionForm.setAttribute('hidden', 'hidden');\n    }\n    const sectionSuccess = document.getElementById('success');\n    if (sectionSuccess) {\n        sectionSuccess.style.display = 'block';\n        sectionSuccess.removeAttribute('hidden');\n    }\n    const sectionContact = document.getElementById('contact');\n    if (sectionContact) {\n        sectionContact.style.display = 'block';\n        sectionContact.removeAttribute('hidden');\n    }\n    window.scrollTo(0, 0);\n}\n\nfunction submitForm() {\n    if (!loading) {\n        loading = true;\n        const form = document.getElementById('rating-form');\n        const submitBtn = form.querySelector('button[type=\"submit\"]');\n        submitBtn.setAttribute('disabled', 'disabled');\n\n        let data = {\n            product_id: productId,\n            vote: []\n        };\n        for (let key in formElements) {\n            if (formElements.hasOwnProperty(key) && formElements[key]) {\n                let elements = form.querySelectorAll(formElements[key].selector);\n                if (!elements || !elements.length) {\n                    continue;\n                }\n                let element = null;\n                for (let i = 0; i < elements.length; i++) {\n                    element = elements[i];\n                    if (!element) {\n                        continue;\n                    }\n                    if (element.type === 'radio') {\n                        if (element.checked) {\n                            data.vote.push({\n                                property_id: formElements[key].id,\n                                value: +element.value\n                            });\n                        }\n                    } else {\n                        data[formElements[key].name] = element.value;\n                    }\n                }\n            }\n        }\n\n        const url = '/api/vote';\n        const method = 'POST';\n        const token = document.querySelector('meta[name=\"csrf-token\"]').getAttribute('content');\n\n        const xhr = new XMLHttpRequest();\n        if ( ( xhr.responseType = 'json') === xhr.responseType ) {\n            xhr.onreadystatechange = function() {\n                if (this.readyState === 4) {\n                    const response = this.response;\n                    if (this.status === 200) {\n                        if (response && response.status && response.status === 'success') {\n                            addProductVoted(productId);\n                            showFormResult();\n                        } else {\n                            console.log('form error, no success', response);\n                            showError('Сталася помилка');\n                        }\n                    } else {\n                        console.log('send form failed', response);\n                        showError('Сталася помилка');\n                    }\n                    loading = false;\n                    submitBtn.removeAttribute('disabled');\n                }\n            }\n            xhr.open(method, url);\n            xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');\n            xhr.setRequestHeader('X-CSRF-TOKEN', token);\n            xhr.send(JSON.stringify(data));\n        } else {\n            console.log('not supported responseType')\n        }\n    }\n}\n\nfunction initForm() {\n    const form = document.getElementById('rating-form');\n    if (!form) return;\n    form.setAttribute('novalidate', 'novalidate');\n\n    for (let key in formElements) {\n        if (formElements.hasOwnProperty(key)) {\n            formElements[key].elements = form.querySelectorAll(formElements[key].selector);\n            if (!formElements[key].elements || !formElements[key].elements.length) {\n                formElements[key] = null;\n            }\n        }\n    }\n\n    form.addEventListener('input', onInput);\n    form.addEventListener('change', onChange);\n\n    const submitBtn = form.querySelector('button[type=\"submit\"]');\n    if (validateForm(formElements)) {\n        submitBtn.removeAttribute('disabled');\n    } else {\n        submitBtn.setAttribute('disabled', 'disabled');\n    }\n\n    form.addEventListener('submit', function (event) {\n        event.preventDefault();\n        if (validateForm(formElements)) {\n            submitForm(event);\n        } else {\n            const submitBtn = form.querySelector('button[type=\"submit\"]');\n            submitBtn.setAttribute('disabled', 'disabled');\n            submitBtn.blur();\n        }\n    });\n}\n\nfunction navigate(pathname = '/') {\n    if (currLocation && currLocation === pathname) return;\n    currLocation = pathname;\n    if (window.location.pathname !== pathname) {\n        if (!window.history || !window.history.pushState) return;\n        window.history.pushState(null, 'link', pathname);\n    }\n    if ((pathname !== '/' && !(/^\\/.+$/i.test(pathname))) || /^\\/admin\\/.*$/i.test(pathname) || pathname == '/admin') {\n        return window.location = pathname;\n    }\n    const path = pathname.split('/');\n    const sectionIndex = document.getElementById('index');\n    if (path && path.length === 2 && path[1] === '') {\n        showSection('index');\n        hideSection('estimate');\n        hideSection('contact');\n        hideSection('success');\n        hideSection('error');\n    } else {\n        hideSection('index');\n    }\n    if (path && path.length === 3 && path[1] === 'product') {\n        if (path[2] && /^\\d+$/i.test(path[2])) {\n            if (!checkIsProductVoted(+path[2])) {\n                getProduct(path[2]);\n            } else {\n                showError(['Дякуємо, але...', 'Ви вже голосували']);\n            }\n        } else {\n            showError('Продукт не знайдено');\n        }\n    }\n    window.scrollTo(0, 0);\n}\n\nfunction handleLink(event) {\n    function isModifiedEvent(event) {\n        return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n    }\n    if (!event || !event.target) return;\n    let target = event.target.nodeName == 'A' ? event.target : event.target.closest('A');\n    if (!target || !window.history || !window.history.pushState) return;\n    const linkTarget = target.getAttribute('target');\n    const href = target.getAttribute('href');\n    if (\n        !event.defaultPrevented && // onClick prevented default\n        event.button === 0 && // ignore everything but left clicks\n        (!linkTarget || linkTarget === '_self') && // let browser handle \"target=_blank\" etc.\n        !isModifiedEvent(event) // ignore clicks with modifier keys\n    ) {\n        if (href && /^\\/.*$/i.test(href)) {\n            event.preventDefault();\n            navigate(href);\n        }\n    }\n}\n\nfunction handlePopstate(event) {\n    navigate(window.location.pathname);\n}\n\nfunction init() {\n    loading = false;\n    navigate(window.location.pathname);\n    document.addEventListener('click', handleLink);\n    window.addEventListener('popstate', handlePopstate)\n}\n\nif (document.readyState == 'loading') {\n    document.addEventListener('DOMContentLoaded', init);\n} else {\n    init();\n}\n\nif (!Element.prototype.matches) {\n    Element.prototype.matches = Element.prototype.msMatchesSelector || \n                                Element.prototype.webkitMatchesSelector;\n}\nif (!Element.prototype.closest) {\n    Element.prototype.closest = function(s) {\n        let el = this;\n        do {\n            if (el.matches(s)) return el;\n            el = el.parentElement || el.parentNode;\n        } while (el !== null && el.nodeType === 1);\n        return null;\n    };\n}"]}